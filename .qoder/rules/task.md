---
trigger: always_on
alwaysApply: true
---
ЗАДАЧА 3: СИСТЕМА ПРЕДИКТИВНОЙ АНАЛИТИКИ
Интеллектуальный мониторинг и прогнозирование дефектов в производстве стекла
2025 | Хакатон РТУ МИРЭА

Цель задачи
Необходимо разработать систему предиктивной аналитики для превентивного контроля качества, которая прогнозирует дефекты и рекомендует корректирующие действия на основе данных от МИК-1 и датчиков оборудования. Система должна выявлять корреляции между параметрами процесса и типами дефектов, предсказывать проблемы за часы вперед и предоставлять операторам действенные рекомендации. 

Основные требования
•	Модели ML для корреляции параметров процесса с типами дефектов
•	Алгоритмы прогнозирования временных рядов для предсказания на 1-6 часов вперед
•	Кластеризация дефектов для группировки похожих случаев и выявления системных проблем
•	Система раннего предупреждения с рекомендациями корректирующих действий
•	Интерактивный дашборд с KPI качества и трендами
•	Интеграция с реальными производственными системами (OPC UA, Modbus)
ПОЛНАЯ АРХИТЕКТУРА СИСТЕМЫ ПРЕДИКТИВНОЙ АНАЛИТИКИ
 
End-to-End Pipepline системы
Данный пайплайн иллюстрирует последовательность этапов построения и применения предиктивной аналитической системы для превентивного мониторинга качества:
•	Сбор данных: На этом этапе осуществляется агрегация данных с всех датчиков, которые находятся на производственной линий, формируется поток данных для последующей обработки
•	Предобработка: Входящие данные очищаются, приводятся к единым формам и проходят фильтрацию от шумов и выбросов, происходит корректировка пропусков, нормализация и слияние информации из разных источников
•	Инженерия признаков: Из обработанных данных извлекаются признаки, вычисляются производные параметры, индексы и другие параметры, необходимые для дальнейшего анализа и повышения эффективности моделей
•	Обучение моделей: На этом этапе строятся и обучаются ML/AI-модели на заранее подготовленных признаках: классификация, регрессия, прогнозирование и так далее
•	Прогнозирование, кластеризация, выявление аномалий: Обученные модели используются для предиктивной аналитики – прогнозирования значимых событий, обнаружения аномалий и кластеризации паттернов
•	Дисплей дашборда: Все результаты аналитики и критерии состояния визуализируются на дашборде для оперативного принятия решений. Здесь оператор получает разметку состояния системы, анализ ключевых показателей и отклонений
•	Алерты и уведомления: При обнаружении критических состояний, аномалий или предсказанных рисков система сразу формирует оповещения и уведомления оператору, обеспечивая быстрый отклик и поддержку принятия решений
ТЕХНОЛОГИЧЕСКИЙ ПРОЦЕСС ПРОИЗВОДСТВА СТЕКЛА
Ниже приведена схема основных этапов производства стекла, с указанием параметров контроля, рисков появления дефектов и областей, требующих повышенного внимания при создании автоматизированной системы мониторинга:
Этап 1 - Подготовка шихты
├─ Смешивание: Кварцевый песок, сода (Na₂CO₃), известь (CaO), плавиковый шпат
├─ Пропорции: Следуют спецификациям рецепта
└─ Контроль: Проверка консистентности материала

Этап 2 - Плавление в печи (КРИТИЧЕН ДЛЯ ДЕФЕКТОВ)
├─ Температура: 1400-1600°C (требует точного контроля)
├─ Длительность: 20-48 часов плавления
├─ Риск: Колебания температуры → трещины, пузыри
├─ Параметры контроля: Температура печи, Давление, Состав газов
└─ Действие: Отрегулировать мощность горелки, расход топлива

Этап 3 - Гомогенизация и охлаждение
├─ Выдержка: Стабильная температура, удаление пузырей воздуха
├─ Скорость охлаждения: 2-5°C в минуту (критично для напряжений)
└─ Риск: Быстрое охлаждение → внутренние трещины

Этап 4 - Контроль вязкости
├─ Температура подбирается для формования
├─ Диапазон: 1000-1200°C
└─ Параметры: Измерение зондом вязкости

Этап 5 - Формование (ВЫСОКИЙ РИСК ДЕФЕКТОВ)
├─ Методы: Прессование, Вытягивание, Центробежное, Выдувание
├─ Скорость: Должна соответствовать возможностям оборудования
├─ Риск: Слишком быстро → неровные стенки, деформация
├─ Риск: Слишком медленно → дефекты охлаждения
├─ Параметры: Скорость формования (м/мин), Давление (МПа), Температура формы
└─ Действие: Регулировать скорость, изменять давление

Этап 6 - Отжиг
├─ Контролируемое охлаждение: 2-5°C в минуту
├─ Длительность: 2-4 часа
├─ Риск: Неправильный график → внутренние напряжения
├─ Параметр: Тепловой профиль, Длительность
└─ Действие: Отрегулировать тепловую кривую

Этап 7 - Контроль качества МИК-1
└─ Выявленные дефекты: 12 типов (трещины, пузыри, сколы и т.д.)
В ходе всего процесса производства стекла используются различные датчики, которые фиксируют параметры и собирают данные. Для каждого датчика задаются свои рабочие диапазоны, частота обновления значений и единицы измерения регистрируемых параметров:
Локация	Тип датчика	Параметр	Единица	Диапазон	Частота
Печь	Термопара тип S	Температура	°C	1200-1700	1/мин
Печь	Манометр	Давление	кПа	0-50	1/мин
Печь	Датчик уровня	Уровень расплава	мм	0-5000	1/5мин
Печь	Газоанализатор	O₂, CO₂	%	0-25	1/10мин
Формование	Термопары	Температура формы	°C	20-600	1/сек
Формование	Датчик давления	Давление формования	МПа	0-100	1/сек
Формование	Энкодер	Скорость ленты	м/мин	0-200	1/сек
Отжиг	Пирометр	Температура изделия	°C	20-1200	1/2сек
Процесс	Расходомер	Подача шихты	кг/ч	0-5000	1/10сек
Качество	Камера (МИК-1)	Дефекты	пх, код	-	1 на единицу
Для обеспечения корректной интеграции, хранения и анализа производственных данных в системе используются стандартизированные форматы обмена информацией:
CSV Формат (Рекомендуется для дашборда): 
timestamp,sensor_id,parameter_name,value,unit,status
2025-11-05T14:30:00Z,FURNACE_01,Temperature,1520.5,C,OK
2025-11-05T14:30:00Z,FURNACE_01,Pressure,15.2,kPa,OK
2025-11-05T14:31:00Z,FORMING_03,FormSpeed,150.0,m/min,OK

JSON Формат (для APIs):
 {
  "timestamp": "2025-11-05T14:30:00Z",
  "production_line": "Line_A",
  "sensors": {
    "furnace": {"temperature": 1520.5, "pressure": 15.2},
    "forming": {"speed": 150.0, "mold_temp": 320}
  },
  "defects": {"count": 2, "types": ["crack", "bubble"]}
}

OPC UA Формат (Промышленный стандарт):
 Server: opc.tcp://mik1_controller:4840/MIK-1
Tags: MIK1.Furnace.Temperature, MIK1.Forming.Speed, и т.д.
Типы данных: Int32 (скорость), Float (температура), Boolean (алерты)
В представленной ниже таблице приведена спецификация используемых на производстве датчиков и соответствующих форматов данных, которая отражает ключевые параметры, поступающие с различных участков линии. 
Параметр	Влияние на дефекты	Диапазон управления	Время отклика	Тип действия
Температура печи	Трещины, помутнения	±30°C	1-2 часа	Отрегулировать горелку
Скорость формования	Пузыри, деформация	±20%	30 сек-5 мин	Изменить скорость мотора
Температура формы	Внутренние напряжения	±50°C	15-30 мин	Управление нагревателем
Состав шихты	Помутнения, сегрегация	Рецепт±5%	30-60 мин	Добавить компоненты
Давление формования	Трещины, слипание	±10 МПа	1-5 сек	Клапан давления
Температура отжига	Остаточные напряжения	График±5°C	2-4 часа	Обновить программу
Скорость охлаждения	Напряжения, деформация	График±0.5°C/мин	30-60 мин	Вентилятор/нагреватель
РЕКОМЕНДУЕМЫЕ ИНТЕРВАЛЫ СБОРА И ГОРИЗОНТЫ ПРОГНОЗИРОВАНИЯ 
В системе автоматизированного мониторинга параметры и сигналы различного типа имеют разную значимость и частоту обновления. Для обеспечения стабильного процесса и оперативного выявления отклонений данные группируются по приоритетам и интервалам съёма. Ниже приведён пример классификации типов информации по уровню важности и рекомендуемой частоте обновления:
•	Критичные параметры (Реальное время): Датчики давления, Термопары (1/сек)
•	Высокий приоритет (Часто): Температура печи, Скорость формования (1/мин)
•	Средний приоритет: Подача шихты, Температура формы (1/5 мин)
•	Низкий приоритет: Данные окружающей среды, Состав газов (1/15 мин)
•	Данные качества: Дефекты МИК-1 (каждый проход изделия ~3-5 сек)
Для реализации предиктивной аналитики формируются прогнозы на различных временных горизонтах, каждый прогноз отличается своим диапазоном, областью применения и наиболее подходящими алгоритмами анализа данных. Следующая таблица демонстрирует классификацию горизонтов прогнозирования, примеры практического использования и рекомендованные алгоритмы для каждой из задач:
Горизонт	Диапазон	Применение	Алгоритм
Краткосрочный	15-60 мин	Немедленное предупреждение оператору	LSTM, Prophet
Среднесрочный	2-6 часов	Планирование смены, время действия	XGBoost, ARIMA
Долгосрочный	8-24 часа	Планирование ресурсов	Prophet, Сезонный
Все изменения параметров, а также горизонты прогнозирования должны динамически изменяться на дашборде:
•	Метрики реального времени: обновлять каждые 5-10 секунд
•	Обновления прогноза: пересчитывать каждые 1-2 минуты
•	Графики трендов: обновлять каждые 30 минут
•	Дневные/недельные отчёты: генерировать в конце смены/дня
•	Исторический анализ: обновлять в фоне, без ожидания пользователя
ИСПОЛЬЗОВАНИЕ НЕЙРОННЫХ СЕТЕЙ В СИСТЕМЕ ПРЕДИКТИВНОЙ АНАЛИТИКИ
Рекомендуется использование нейронных сетей для предиктивного анализа дефектов, поскольку они демонстрируют более высокую эффективность по сравнению с классическими методами машинного обучения для задач обнаружения сложных закономерностей в данных производственного процесса и прогнозирования временных рядов.
LSTM для прогнозирования временных рядов
Сети с долгой краткосрочной памятью (LSTM):
 Архитектура:
├─ Специализированная RNN для последовательных данных (временные ряды)
├─ Ячейки памяти предотвращают проблему исчезающего градиента
├─ Вход: Исторические данные датчиков (прошлые 1-6 часов)
└─ Выход: Прогнозируемая вероятность дефекта в следующие 1-2 часа

Преимущества:
├─ Захватывает долгосрочные зависимости в данных
├─ Изучает циклические паттерны производства
├─ Прогнозирует несколько шагов вперед (1ч, 4ч, 24ч)
├─ Обрабатывает нелинейные корреляции
└─ Обеспечивает интервалы уверенности

Рекомендуемая конфигурация:
├─ Временное окно: 60-120 шагов (1-2 часа исторических данных)
├─ Слои LSTM: 2-3 штабелированных (128-256 единиц каждый)
├─ Dropout: 0.2-0.3 (предотвращение переобучения)
├─ Dense слой: 64 нейрона с ReLU
└─ Выход: 1 нейрон с сигмоидой (вероятность)

Целевые показатели производительности:
├─ Точность прогноза: >85% на 1 час вперед
├─ Полнота (Recall): >90% (поймать реальные дефекты)
├─ Точность (Precision): >80% (избежать ложных алертов)
└─ Время обучения: 2-4 часа на одном GPU
Рекомендуемый гибридный подход
•	Краткосрочный (15-60 мин): Сеть LSTM (лучшее для немедленного прогноза)
•	Среднесрочный (2-6 часов): Gradient Boosting (XGBoost/CatBoost)
•	Долгосрочный (8-24 часа): Prophet (хорошо обрабатывает сезонность)
•	Ансамбль: комбинировать прогнозы взвешенным голосованием (LSTM 40%, XGBoost 35%, Prophet 25%)
•	Обоснование: Разные модели превосходят на разных горизонтах времен
АРХИТЕКТУРА ДАШБОРДА
Дашборд должен иметь чётко определённую структуру, соответствующую представленному ниже списку, и обеспечивать отображение как аналитики в реальном времени, так и предиктивных данных по ключевым разделам системы:
Строка заголовка:
├─ Название системы и индикатор статуса (Online/Offline)
├─ Информация о текущей смене (№ смены, начало, длительность)
├─ Селектор дат и времени (Последние 24ч / Неделя / Месяц / Своё)
└─ Кнопка экспорта (Отчёт, CSV, PDF)

Карточки KPI (4-6 метрик):
├─ Всего дефектов: Большое число со стрелкой тренда (↑/↓) + %изменения
├─ Рейтинг качества: Процент с цветовым кодированием (Зелёный>95%, Жёлтый 85-95%, Красный<85%)
├─ Критических алертов: Счётчик с красным значком
├─ Точность прогноза: % правильных предсказаний за 24ч
├─ Производительность: Единиц/час с трендом
└─ Среднее время ответа: Минуты от алерта до действия

Основная область визуализации (Интерфейс с вкладками):
├─ Вкладка 1: Дефекты в реальном времени (Живой поток, Координаты дефектов)
├─ Вкладка 2: Прогнозные графики (График прогноза, Доверительные полосы)
├─ Вкладка 3: Корреляции (Тепловая карта: Параметры vs Дефекты)
├─ Вкладка 4: Кластеризация (Группировка дефектов, Выявление аномалий)
└─ Вкладка 5: Исторический анализ (Тренды, Сезонные паттерны)

Панель рекомендаций:
├─ Макет на основе карточек, каждая = 1 действие
├─ Цветовое кодирование срочности (Красный: Выполнить сейчас, Оранжевый: Следующие 30мин, Жёлтый: В течение 2ч)
├─ Уверенность % и обоснование (Почему это действие?)
├─ Кнопки "Применено" / "Отклонено" для обратной связи
└─ Прогноз влияния: Ожидаемое улучшение при выполнении

Отображение алертов:
├─ Прокручиваемый список, новые первыми
├─ Иконка + Текст + Временная метка
├─ Опция звукового уведомления (переключатель)
├─ Кнопка подтверждения
└─ Ссылка на детальный анализ
•	Строка KPI: Количество дефектов (смена/день/неделя), Качество %, Точность прогноза, Статус системы
•	Графики трендов: Дефекты со временем, Тренд качества, Предсказано vs Фактически
•	Тепловая карта: Корреляции между параметрами (темп, скорость, состав) и типами дефектов
•	Распределение дефектов: По позиции на изделии, по типу, по уровню серьёзности
•	Панель рекомендаций: Упорядоченные корректирующие действия с оценками уверенности
•	Раздел алертов: Предупреждения CRITICAL/HIGH/MEDIUM с временными метками
•	Фильтры: Временной диапазон, тип дефекта, серьёзность, линия, пороги
ТЕХНИЧЕСКИЙ СТЕК И РЕКОМЕНДАЦИИ ФРЕЙМВОРКОВ
•	Сбор данных: Python OPC UA клиент, MQTT подписчик или Modbus RTU драйвер
•	Хранение: InfluxDB (временные ряды) + PostgreSQL (метаданные)
•	Обработка: Apache Kafka для потоков, или простые Python очереди
•	ML библиотеки: TensorFlow/Keras (LSTM), scikit-learn (предобработка), XGBoost
•	Прогнозирование: Prophet (Facebook), ARIMA/SARIMA из statsmodels
•	Кластеризация: K-means scikit-learn, DBSCAN
•	Дашборд: Python Dash или React.js фронтенд
•	Бэкенд: FastAPI или Flask
•	Развёртывание: Docker + Kubernetes, или AWS EC2
•	Мониторинг: Prometheus + Grafana, или MLflow

Рекомендуемый технологический стек для UI
•	Фронтенд: React.js + TypeScript для компонентной архитектуры
•	Графики: Plotly.js или Apache ECharts для интерактивных визуализаций
•	Тепловая карта: D3.js или seaborn (Python) экспортированные как компоненты
•	3D модель: Three.js для 3D визуализации изделия с маркерами дефектов
•	Управление состоянием: Redux или Context API
•	Бэкенд: Python FastAPI или Node.js Express
•	Обновления в реальном времени: WebSocket для потокового обновления данных
•	Мобильная поддержка: Адаптивный дизайн (React Bootstrap или Material-UI)
