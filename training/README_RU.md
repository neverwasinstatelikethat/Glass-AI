# Модуль обучения моделей

## Обзор

Модуль обучения моделей предоставляет инструменты и процессы для обучения, настройки и непрерывного улучшения ML-моделей системы предиктивной аналитики. Этот модуль обеспечивает автоматизированное обучение, отслеживание метрик и адаптацию моделей к изменяющимся условиям производства.

## Компоненты

### 1. Synthetic Training Data Generator (synthetic_training_data_generator.py)
Генератор синтетических данных для обучения моделей.

#### Основные возможности:
- **Реалистичные данные**: Создание синтетических данных, имитирующих реальные производственные процессы
- **Аномалии и дефекты**: Генерация данных с различными типами аномалий и дефектов
- **Временные ряды**: Создание временных рядов с реалистичными паттернами
- **Настройка параметров**: Гибкая настройка характеристик генерируемых данных

### 2. AutoML Tuner (automl_tuner.py)
Автоматическая настройка гиперпараметров моделей.

#### Основные возможности:
- **Оптимизация гиперпараметров**: Автоматический поиск оптимальных гиперпараметров
- **Bayesian оптимизация**: Использование байесовских методов для эффективного поиска
- **Многокритериальная оптимизация**: Оптимизация по нескольким метрикам одновременно
- **Ранняя остановка**: Прекращение малоэффективных экспериментов

### 3. Continuous Learning (continuous_learning.py)
Система непрерывного обучения моделей на новых данных.

#### Основные возможности:
- **Инкрементальное обучение**: Обновление моделей без повторного обучения с нуля
- **Обнаружение дрейфа**: Выявление изменений в распределении данных
- **Адаптация моделей**: Автоматическая адаптация к новым условиям
- **Валидация качества**: Постоянный контроль качества моделей

### 4. Federated Learning (federated_learning.py)
Федеративное обучение для распределенных производственных линий.

#### Основные возможности:
- **Распределенное обучение**: Обучение моделей на данных с нескольких производственных линий
- **Конфиденциальность**: Сохранение конфиденциальности данных на локальных узлах
- **Агрегация моделей**: Комбинирование знаний от разных производственных линий
- **Гетерогенные данные**: Работа с данными различной структуры и качества

### 5. ML Metrics Tracker (ml_metrics_tracker.py)
Отслеживание и визуализация метрик машинного обучения.

#### Основные возможности:
- **Мониторинг метрик**: Непрерывный сбор метрик производительности моделей
- **Визуализация**: Графики и дашборды для анализа метрик
- **Алертинг**: Уведомления о критических изменениях метрик
- **История экспериментов**: Хранение истории всех экспериментов и их результатов

## Использование

### Генератор синтетических данных:
```python
from training.synthetic_training_data_generator import SyntheticTrainingDataGenerator

# Создание генератора
generator = SyntheticTrainingDataGenerator()

# Генерация данных для обучения LSTM
lstm_data = generator.generate_lstm_training_data(
    sequence_length=30,
    num_samples=10000,
    defect_types=["crack", "bubble", "chip"]
)
```

### AutoML tuner:
```python
from training.automl_tuner import AutoMLTuner

# Создание tuner'а
tuner = AutoMLTuner()

# Настройка гиперпараметров LSTM
best_params = tuner.optimize_lstm_hyperparameters(
    training_data=lstm_data,
    search_space={
        "layers": [2, 3, 4],
        "units": [64, 128, 256],
        "dropout": [0.1, 0.2, 0.3]
    }
)
```

### Непрерывное обучение:
```python
from training.continuous_learning import ContinuousLearningSystem

# Создание системы непрерывного обучения
cl_system = ContinuousLearningSystem(model_path="models/lstm_model.onnx")

# Обновление модели на новых данных
cl_system.update_model(new_data_stream, performance_threshold=0.85)
```

### Федеративное обучение:
```python
from training.federated_learning import FederatedLearningCoordinator

# Создание координатора федеративного обучения
fl_coordinator = FederatedLearningCoordinator()

# Координация обучения между несколькими узлами
global_model = fl_coordinator.coordinate_training(
    node_data_sources=node_data_list,
    rounds=10,
    aggregation_method="fedavg"
)
```

### Отслеживание метрик:
```python
from training.ml_metrics_tracker import MLMetricsTracker

# Создание tracker'а
tracker = MLMetricsTracker(experiment_name="lstm_training_v1")

# Логирование метрик
tracker.log_metrics({
    "accuracy": 0.92,
    "precision": 0.89,
    "recall": 0.94,
    "f1_score": 0.91
})
```

## Интеграция

Модуль обучения тесно интегрирован с другими компонентами системы:
- **ML-модели**: Обеспечивает обучение и оптимизацию всех моделей
- **Метрики ML**: Сбор и анализ метрик производительности моделей
- **Цифровой двойник**: Использование синтетических данных для обучения
- **Потоковая обработка**: Получение новых данных для непрерывного обучения

## Преимущества

1. **Автоматизация**: Минимизация ручного труда при настройке и обучении моделей
2. **Адаптивность**: Постоянное улучшение моделей на новых данных
3. **Масштабируемость**: Поддержка распределенного обучения на нескольких производственных линиях
4. **Контроль качества**: Постоянный мониторинг и валидация качества моделей
5. **Эффективность**: Оптимизированные процессы обучения и настройки