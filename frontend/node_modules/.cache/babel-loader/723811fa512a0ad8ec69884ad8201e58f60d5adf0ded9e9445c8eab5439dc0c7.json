{"ast":null,"code":"import{useState,useEffect,useRef}from'react';const useWebSocket=function(url){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const[isConnected,setIsConnected]=useState(false);const[error,setError]=useState(null);const wsRef=useRef(null);useEffect(()=>{// Create WebSocket connection\nconst ws=new WebSocket(url);wsRef.current=ws;// Connection opened\nws.onopen=()=>{console.log('WebSocket connection established');setIsConnected(true);setError(null);if(options.onOpen){options.onOpen();}};// Listen for messages\nws.onmessage=event=>{try{const data=JSON.parse(event.data);console.log('WebSocket message received:',data);if(options.onMessage){options.onMessage(data);}}catch(e){console.error('Error parsing WebSocket message:',event.data);}};// Connection closed\nws.onclose=()=>{console.log('WebSocket connection closed');setIsConnected(false);if(options.onClose){options.onClose();}};// Connection error\nws.onerror=err=>{console.error('WebSocket error:',err);setError(err);setIsConnected(false);if(options.onError){options.onError(err);}};// Cleanup function\nreturn()=>{if(ws.readyState===WebSocket.OPEN){ws.close();}};},[url,options]);const sendMessage=message=>{if(wsRef.current&&wsRef.current.readyState===WebSocket.OPEN){wsRef.current.send(JSON.stringify(message));}else{console.warn('WebSocket is not connected. Message not sent:',message);}};const sendPing=()=>{sendMessage({type:'ping'});};const subscribe=topics=>{sendMessage({type:'subscribe',topics});};return{isConnected,error,sendMessage,sendPing,subscribe};};export default useWebSocket;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}